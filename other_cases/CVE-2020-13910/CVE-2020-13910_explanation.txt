Description of CVE-2020-13910(CWE-787): Pengutronix Barebox through v2020.05.0 has an out-of-bounds write in nfs_read_reply in net/nfs.c because a field of an incoming network packet is directly used as a length field without any bounds check.

Patch:diff --git a/net/nfs.c b/net/nfs.c
index 63573098d7..591417e0de 100644
--- a/net/nfs.c
+++ b/net/nfs.c
@@ -533,7 +533,7 @@ static int nfs_readlink_reply(unsigned char *pkt, unsigned len)
 
 static int nfs_read_reply(unsigned char *pkt, unsigned len)
 {
-	int rlen;
+	unsigned int rlen;
 	uint32_t *data;
 	int ret;
 
@@ -552,6 +552,8 @@ static int nfs_read_reply(unsigned char *pkt, unsigned len)
 
 	rlen = ntohl(net_read_uint32(data + 18));
 
+	rlen = max_t(unsigned int, rlen, len - 19);
+
 	ret = write(net_store_fd, (char *)(data + 19), rlen);
 	if (ret < 0) {
 		perror("write");

Explanation of VGExplainer: We can see the vulnerability path clearly in lineï¼š "data = (uint32_t *)(pkt + sizeof(struct rpc_reply));", "rlen = ntohl(net_read_uint32(data + 18))	", "ret = write(net_store_fd, (char *)(data + 19), rlen);"
