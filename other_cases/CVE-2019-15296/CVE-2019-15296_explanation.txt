Description of CVE-2019-15296: An issue was discovered in Freeware Advanced Audio Decoder 2 (FAAD2) 2.8.8. The faad_resetbits function in libfaad/bits.c is affected by a buffer overflow vulnerability. The number of bits to be read is determined by ld->buffer_size - words*4, cast to uint32. If ld->buffer_size - words*4 is negative, a buffer overflow is later performed via getdword_n(&ld->start[words], ld->bytes_left).

Patch:
@@ -167,7 +167,10 @@ void faad_resetbits(bitfile *ld, int bits)
    int words = bits >> 5;
    int remainder = bits & 0x1F;

-    ld->bytes_left = ld->buffer_size - words*4;
+    if (ld->buffer_size < words * 4)
+        ld->bytes_left = 0;
+    else
+        ld->bytes_left = ld->buffer_size - words*4;

    if (ld->bytes_left >= 4)
    {

Explanation of VGExplainer: We can see the vulnerability path clearly in line： "int words = bits >> 5;", "ld->bytes_left = ld->buffer_size - words*4;", “if (ld->bytes_left >= 4)”， "tmp = getdword_n(&ld->start[words], ld->bytes_left);"